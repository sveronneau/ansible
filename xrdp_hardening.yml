---

- name: Lockdown XRDP to accept connections only on localhost
  lineinfile:
    dest: /etc/xrdp/xrdp.ini
    regexp: '^(.*)port=3389(.*)$'
    line: 'port=tcp://.:3389'
    backrefs: yes

- name: Set local username for RDP connection in xrdp.ini
  lineinfile:
    dest: /etc/xrdp/xrdp.ini
    regexp: '^(.*)username=ask(.*)$'
    line: 'username=datascientist'
    backrefs: yes

- name: Set local password for RDP connection in xrdp.ini
  lineinfile:
    dest: /etc/xrdp/xrdp.ini
    regexp: '^(.*)password=ask(.*)$'
    line: 'password=$DataSci3ntist!$'
    backrefs: yes

- name: Restart service xrdp to apply hardened configs
  service:
    name: xrdp
    state: restarted
